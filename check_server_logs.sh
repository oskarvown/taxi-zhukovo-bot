#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ"
echo "=================================="
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞
echo "1Ô∏è‚É£ –°—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã –±–æ—Ç–∞:"
echo "-------------------"
systemctl status taxi-bot --no-pager -l | head -20
echo ""

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
echo "2Ô∏è‚É£ –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤:"
echo "---------------------------"
journalctl -u taxi-bot -n 50 --no-pager
echo ""

# –û—à–∏–±–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
echo "3Ô∏è‚É£ –û—à–∏–±–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å:"
echo "------------------------"
journalctl -u taxi-bot --since "1 hour ago" | grep -i error | tail -20
echo ""

# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫)
echo "4Ô∏è‚É£ –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ (–¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞):"
echo "------------------------------------------------"
journalctl -u taxi-bot -n 100 --no-pager
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤
echo "5Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤:"
echo "------------------------"
if [ -f /opt/taxi-zhukovo/logs/bot.log ]; then
    echo "‚úÖ bot.log —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    echo "   –†–∞–∑–º–µ—Ä: $(du -h /opt/taxi-zhukovo/logs/bot.log | cut -f1)"
    echo "   –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫:"
    tail -20 /opt/taxi-zhukovo/logs/bot.log
else
    echo "‚ùå bot.log –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi
echo ""

if [ -f /opt/taxi-zhukovo/logs/bot_error.log ]; then
    echo "‚úÖ bot_error.log —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    echo "   –†–∞–∑–º–µ—Ä: $(du -h /opt/taxi-zhukovo/logs/bot_error.log | cut -f1)"
    if [ -s /opt/taxi-zhukovo/logs/bot_error.log ]; then
        echo "   –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫ –æ—à–∏–±–æ–∫:"
        tail -20 /opt/taxi-zhukovo/logs/bot_error.log
    else
        echo "   –§–∞–π–ª –ø—É—Å—Ç (–Ω–µ—Ç –æ—à–∏–±–æ–∫)"
    fi
else
    echo "‚ùå bot_error.log –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi
echo ""

# –ü–æ–∏—Å–∫ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ /start
echo "6Ô∏è‚É£ –ü–æ–∏—Å–∫ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –∫–æ–º–∞–Ω–¥—ã /start –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å:"
echo "---------------------------------------------------"
journalctl -u taxi-bot --since "1 hour ago" | grep -i "/start" | tail -20
echo ""

# –ü–æ–∏—Å–∫ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
echo "7Ô∏è‚É£ –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:"
echo "------------------------------"
journalctl -u taxi-bot --since "1 hour ago" | grep -iE "auth|phone|verification|ensure_user" | tail -20
echo ""

echo "=================================="
echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"
echo ""
echo "üí° –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:"
echo "   journalctl -u taxi-bot -f"
echo ""
echo "üí° –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫:"
echo "   journalctl -u taxi-bot -n 100 | grep -i error"







