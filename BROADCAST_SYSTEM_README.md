# Broadcast-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–æ–Ω

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–ª—è –∑–∞–∫–∞–∑–æ–≤ –∏–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∑–æ–Ω (–£—Ñ–∞, –ü—Ä–æ—á–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –ñ–î-–≤–æ–∫–∑–∞–ª, –ê—ç—Ä–æ–ø–æ—Ä—Ç).

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

#### –î–ª—è –∫–æ–≥–æ –≤–∫–ª—é—á–∞–µ—Ç—Å—è broadcast:
- **–£—Ñ–∞**: –≤—Å–µ —Ä–∞–π–æ–Ω—ã (–£—Ñ–∞-–¶–µ–Ω—Ç—Ä, –¢–µ–ª–µ—Ü–µ–Ω—Ç—Ä, –°–∏–ø–∞–π–ª–æ–≤–æ, –ß–µ—Ä–Ω–∏–∫–æ–≤–∫–∞, –ß–µ—Å–Ω–æ–∫–æ–≤–∫–∞, –ò–Ω–æ—Ä—Å, –ó–µ–ª—ë–Ω–∞—è —Ä–æ—â–∞)
- **–ü—Ä–æ—á–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: –î–º–∏—Ç—Ä–∏–µ–≤–∫–∞, –ú–∏—Ö–∞–π–ª–æ–≤–∫–∞, –ú–∏–ª–æ–≤—Å–∫–∏–π –ü–∞—Ä–∫, –ú–∏–ª–æ–≤–∫–∞, –ù–∏–∫–æ–ª–∞–µ–≤–∫–∞, –Æ–º–∞—Ç–æ–≤–æ, –ê–ª–∫–∏–Ω–æ, –ö–∞—Ñ–µ –û—Ç–¥—ã—Ö, –ò–≥–ª–∏–Ω–æ, –®–∞–∫—à–∞, –ê–∫–±–µ—Ä–¥–∏–Ω–æ, –ù–∞–≥–∞–µ–≤–æ, –ß–∏—à–º—ã
- **–ñ–î-–≤–æ–∫–∑–∞–ª**: –ñ/–î –≤–æ–∫–∑–∞–ª
- **–ê—ç—Ä–æ–ø–æ—Ä—Ç**: –ê—ç—Ä–æ–ø–æ—Ä—Ç (–ª—é–±–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª)

#### –ö–æ–≥–æ —É–≤–µ–¥–æ–º–ª—è–µ–º:
1. **–°–≤–æ–±–æ–¥–Ω—ã–µ –≤–æ–¥–∏—Ç–µ–ª–∏** (status=online) ‚Äî –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –∑–æ–Ω–µ
2. **–ó–∞–Ω—è—Ç—ã–µ "–ø–æ –ø—É—Ç–∏"** (status=busy) ‚Äî –µ—Å–ª–∏:
   - –¢–µ–∫—É—â–∞—è –ø–æ–µ–∑–¥–∫–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤ –∑–æ–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
   - ETA –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚â§ 15 –º–∏–Ω—É—Ç

#### –ü—Ä–æ—Ü–µ—Å—Å:
1. **–ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑** ‚Üí —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–æ–Ω—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. **–ï—Å–ª–∏ broadcast-–∑–æ–Ω–∞** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–º –≤–æ–¥–∏—Ç–µ–ª—è–º
3. **–°–≤–æ–±–æ–¥–Ω–æ–º—É –≤–æ–¥–∏—Ç–µ–ª—é** ‚Üí –∫–Ω–æ–ø–∫–∞ "‚úÖ –ü—Ä–∏–Ω—è—Ç—å"
4. **–ó–∞–Ω—è—Ç–æ–º—É –ø–æ –ø—É—Ç–∏** ‚Üí –∫–Ω–æ–ø–∫–∞ "üìå –í–∑—è—Ç—å –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π"
5. **–ü–µ—Ä–≤—ã–π –æ—Ç–∫–ª–∏–∫**:
   - –°–≤–æ–±–æ–¥–Ω—ã–π –ø—Ä–∏–Ω—è–ª ‚Üí –∑–∞–∫–∞–∑ —Å—Ä–∞–∑—É –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è
   - –ó–∞–Ω—è—Ç—ã–π –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–ª ‚Üí –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∂–¥–∞—Ç—å
6. **–ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–∂–∏–¥–∞–Ω–∏–µ** ‚Üí –∑–∞–∫–∞–∑ –∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è –∑–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–º
7. **–í–æ–¥–∏—Ç–µ–ª—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø–æ–µ–∑–¥–∫—É** ‚Üí –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–∫–∞–∑

#### –¢–∞–π–º–∞—É—Ç—ã:
- **30 —Å–µ–∫—É–Ω–¥** ‚Äî –æ–∫–Ω–æ –¥–ª—è –æ—Ç–∫–ª–∏–∫–æ–≤ (–µ—Å–ª–∏ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–Ω—è–ª ‚Üí —Å—Ç–∞—Ç—É—Å EXPIRED)
- **15 –º–∏–Ω—É—Ç** ‚Äî —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ä–µ–∑–µ—Ä–≤–∞ (–µ—Å–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—å –Ω–µ –æ—Å–≤–æ–±–æ–¥–∏–ª—Å—è)

## üóÉÔ∏è –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `drivers`
```sql
ALTER TABLE drivers ADD COLUMN next_finish_zone VARCHAR;
ALTER TABLE drivers ADD COLUMN eta_to_finish INTEGER;
```

### –¢–∞–±–ª–∏—Ü–∞ `orders`
```sql
ALTER TABLE orders ADD COLUMN is_broadcast BOOLEAN DEFAULT FALSE NOT NULL;
ALTER TABLE orders ADD COLUMN reserved_driver_id INTEGER REFERENCES drivers(id);
ALTER TABLE orders ADD COLUMN reserve_expires_at TIMESTAMP;
CREATE INDEX idx_orders_is_broadcast ON orders(is_broadcast);
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
```bash
python database/migrations/add_broadcast_fields.py upgrade
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π –≤ drivers
sqlite3 taxi_zhukovo.db "PRAGMA table_info(drivers);"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–µ–π –≤ orders
sqlite3 taxi_zhukovo.db "PRAGMA table_info(orders);"
```

### 3. –û—Ç–∫–∞—Ç (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```bash
python database/migrations/add_broadcast_fields.py downgrade
```

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

- `bot/services/broadcast_service.py` ‚Äî –ª–æ–≥–∏–∫–∞ broadcast-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `bot/handlers/broadcast_handlers.py` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback-–∫–Ω–æ–ø–æ–∫
- `database/migrations/add_broadcast_fields.py` ‚Äî –º–∏–≥—Ä–∞—Ü–∏—è –ë–î

## üîÑ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `bot/models/driver.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `next_finish_zone`, `eta_to_finish`
- `bot/models/order.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è `is_broadcast`, `reserved_driver_id`, `reserve_expires_at`
- `bot/services/order_service.py` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä `is_broadcast` –≤ `create_order()`
- `bot/handlers/user.py` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è broadcast –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞
- `bot/main.py` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è broadcast-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–≤–æ–±–æ–¥–Ω—ã–π –≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–∫–∞–∑
1. **–ö–ª–∏–µ–Ω—Ç**: –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∏–∑ –£—Ñ—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –£—Ñ–∞-–¶–µ–Ω—Ç—Ä)
2. **–í–æ–¥–∏—Ç–µ–ª—å** (online): –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π "‚úÖ –ü—Ä–∏–Ω—è—Ç—å"
3. **–í–æ–¥–∏—Ç–µ–ª—å**: –ù–∞–∂–∞—Ç—å "–ü—Ä–∏–Ω—è—Ç—å"
4. **–ö–ª–∏–µ–Ω—Ç**: –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–∏–Ω—è—Ç–∏–∏ –∑–∞–∫–∞–∑–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ó–∞–Ω—è—Ç—ã–π –≤–æ–¥–∏—Ç–µ–ª—å —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –∑–∞–∫–∞–∑
1. **–í–æ–¥–∏—Ç–µ–ª—å 1** (busy, next_finish_zone="–£—Ñ–∞-–¶–µ–Ω—Ç—Ä", eta=10): 
   - –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π "üìå –í–∑—è—Ç—å –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π"
   - –ù–∞–∂–∞—Ç—å "–í–∑—è—Ç—å –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π"
2. **–ö–ª–∏–µ–Ω—Ç**: –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∂–¥–∞—Ç—å ‚âà10 –º–∏–Ω
3. **–ö–ª–∏–µ–Ω—Ç**: –ù–∞–∂–∞—Ç—å "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–∂–∏–¥–∞–Ω–∏–µ"
4. **–í–æ–¥–∏—Ç–µ–ª—å 1**: –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏
5. **–í–æ–¥–∏—Ç–µ–ª—å 1**: –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø–æ–µ–∑–¥–∫—É ‚Üí –ø—Ä–∏–Ω—è—Ç—å –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–∫–∞–∑

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª–æ–Ω—è–µ—Ç —Ä–µ–∑–µ—Ä–≤
1. **–í–æ–¥–∏—Ç–µ–ª—å** (busy): –†–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç –∑–∞–∫–∞–∑
2. **–ö–ª–∏–µ–Ω—Ç**: –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∂–¥–∞—Ç—å
3. **–ö–ª–∏–µ–Ω—Ç**: –ù–∞–∂–∞—Ç—å "‚ùå –û—Ç–º–µ–Ω–∏—Ç—å"
4. **–°–∏—Å—Ç–µ–º–∞**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–∫–∞–∑ –≤ –æ–±—â–∏–π –ø—É–ª

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –¢–∞–π–º–∞—É—Ç broadcast-–æ–∫–Ω–∞
1. **–ö–ª–∏–µ–Ω—Ç**: –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ –∏–∑ –ñ/–î –≤–æ–∫–∑–∞–ª–∞
2. **–í–æ–¥–∏—Ç–µ–ª–∏**: –ù–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 30 —Å–µ–∫—É–Ω–¥
3. **–ö–ª–∏–µ–Ω—Ç**: –ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–ù–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–Ω—è–ª –∑–∞–∫–∞–∑"
4. **–ó–∞–∫–∞–∑**: –°—Ç–∞—Ç—É—Å ‚Üí EXPIRED

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è broadcast –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- `‚úÖ Broadcast –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —Å–≤–æ–±–æ–¥–Ω–æ–º—É –≤–æ–¥–∏—Ç–µ–ª—é #ID`
- `‚úÖ Broadcast —Ä–µ–∑–µ—Ä–≤ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∑–∞–Ω—è—Ç–æ–º—É –≤–æ–¥–∏—Ç–µ–ª—é #ID`
- `‚úÖ –í–æ–¥–∏—Ç–µ–ª—å #ID –ø—Ä–∏–Ω—è–ª broadcast-–∑–∞–∫–∞–∑ #ORDER_ID`
- `üìå –í–æ–¥–∏—Ç–µ–ª—å #ID –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–ª –∑–∞–∫–∞–∑ #ORDER_ID`
- `‚úÖ –ö–ª–∏–µ–Ω—Ç –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª —Ä–µ–∑–µ—Ä–≤ –¥–ª—è –∑–∞–∫–∞–∑–∞ #ORDER_ID`
- `‚ùå –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª–æ–Ω–∏–ª —Ä–µ–∑–µ—Ä–≤ –¥–ª—è –∑–∞–∫–∞–∑–∞ #ORDER_ID`
- `‚è∞ Broadcast-–æ–∫–Ω–æ –∏—Å—Ç–µ–∫–ª–æ –¥–ª—è –∑–∞–∫–∞–∑–∞ #ORDER_ID`
- `‚è∞ –†–µ–∑–µ—Ä–≤ –∏—Å—Ç–µ–∫ –¥–ª—è –∑–∞–∫–∞–∑–∞ #ORDER_ID`

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–í `bot/services/broadcast_service.py`:

```python
BROADCAST_WINDOW_SECONDS = 30  # –û–∫–Ω–æ –¥–ª—è –æ—Ç–∫–ª–∏–∫–æ–≤
MAX_ETA_FOR_RESERVE_MINUTES = 15  # –ú–∞–∫—Å ETA –¥–ª—è —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–∏
RESERVE_TTL_MINUTES = 15  # –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ä–µ–∑–µ—Ä–≤–∞
```

## üö® –í–∞–∂–Ω–æ

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- –í–æ–¥–∏—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω—è—Ç—å –¥–≤–∞ –∑–∞–∫–∞–∑–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –†–µ–∑–µ—Ä–≤ –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ —É –≤–æ–¥–∏—Ç–µ–ª—è —Å —Ñ–∏–Ω–∏—à–µ–º –≤ –∑–æ–Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –†–µ–∑–µ—Ä–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–Ω–∏–º–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç
- –ó–∞–∫–∞–∑ expires —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥, –µ—Å–ª–∏ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏–Ω—è–ª

### –î–ª—è –æ–±—ã—á–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤:
- –ó–∞–∫–∞–∑—ã –∏–∑ –±–∞–∑–æ–≤—ã—Ö –∑–æ–Ω (–°—Ç–∞—Ä–æ–µ/–ù–æ–≤–æ–µ –ñ—É–∫–æ–≤–æ, –ú—ã—Å–æ–≤—Ü–µ–≤–æ, –î—ë–º–∞, –ê–≤–¥–æ–Ω, –£–ø—Ç–∏–Ω–æ) **–ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç broadcast**
- –î–ª—è –Ω–∏—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—ã—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π FIFO

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

```sql
-- –ê–∫—Ç–∏–≤–Ω—ã–µ broadcast-–∑–∞–∫–∞–∑—ã
SELECT * FROM orders WHERE is_broadcast = TRUE AND status = 'new';

-- –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã
SELECT * FROM orders WHERE reserved_driver_id IS NOT NULL;

-- –ó–∞–Ω—è—Ç—ã–µ –≤–æ–¥–∏—Ç–µ–ª–∏ —Å ETA
SELECT * FROM drivers WHERE status = 'busy' AND eta_to_finish IS NOT NULL;

-- –ò—Å—Ç—ë–∫—à–∏–µ –∑–∞–∫–∞–∑—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è
SELECT COUNT(*) FROM orders 
WHERE is_broadcast = TRUE 
  AND status = 'expired' 
  AND DATE(created_at) = DATE('now');
```

## üîß –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ broadcast –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–æ–Ω—É –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è**:
   ```python
   from bot.services.broadcast_service import BroadcastService
   BroadcastService.is_broadcast_zone("–£—Ñ–∞-–¶–µ–Ω—Ç—Ä")  # ‚Üí True
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ–¥–∏—Ç–µ–ª–µ–π**:
   ```sql
   SELECT id, status, next_finish_zone, eta_to_finish 
   FROM drivers WHERE status IN ('online', 'busy');
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏**:
   ```bash
   tail -f bot.log | grep broadcast
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–∫–∞–∑**:
   ```sql
   SELECT id, status, is_broadcast, reserved_driver_id, reserve_expires_at 
   FROM orders WHERE id = <ORDER_ID>;
   ```

